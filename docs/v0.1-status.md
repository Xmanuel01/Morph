Enkai v0.1 Status vs Enkai.spec

Legend:
- Implemented: behavior matches spec in v0.1.
- Partial: parsed or stubbed, but runtime/semantics incomplete.
- TODO: not implemented yet.

1) Lexical structure
- Line comments // (Implemented) — `enkaic/src/lexer.rs` (Lexer::tokenize, Lexer::skip_line_comment).
- Block comments /* */ (Implemented, non-nesting) — `enkaic/src/lexer.rs` (Lexer::tokenize, in_block_comment).
- Identifiers [A-Za-z_][A-Za-z0-9_]* (Implemented, ASCII only) — `enkaic/src/lexer.rs` (lex_ident_or_keyword).
- Keywords list (Implemented) — `enkaic/src/lexer.rs` (lex_ident_or_keyword).
- Integer/float literals with underscores + exponents (Implemented) — `enkaic/src/lexer.rs` (lex_number).
- String literals with escapes (Implemented) — `enkaic/src/lexer.rs` (lex_string).
- Newlines separate statements unless inside () or [] (Implemented) — `enkaic/src/lexer.rs` (paren_depth, bracket_depth).
- Operators/punctuation tokens (Implemented) — `enkaic/src/lexer.rs` (lex_punct).
- "=" only for named args/config fields (Partial) — parser rejects "=" for bindings but spec allows assignment expressions; see divergences.

2) "::" blocks and validation
- Block start/end detection (Implemented) — `enkaic/src/lexer.rs` (Lexer::finish_line, TokenKind::BlockStart/BlockEnd).
- Trailing whitespace allowed (Implemented) — `enkaic/src/lexer.rs` (whitespace skipped).
- Trailing "// comment" after :: allowed (Implemented) — `enkaic/src/lexer.rs` (skip_line_comment before finish_line).
- No extra tokens after :: (Implemented) — `enkaic/src/lexer.rs` (finish_line validation).
- Block stack validation (Implemented) — `enkaic/src/lexer.rs` (block_depth).

3) Grammar and constructs
- Modules/items (Implemented) — `enkaic/src/parser.rs` (parse_module, parse_item).
- use declarations (Partial) — parser in `enkaic/src/parser.rs` (parse_use_decl); runtime only resolves built-in std records in `enkairt/src/runtime.rs` (Interpreter::eval_use_decl).
- fn declarations (Implemented, sync only) — `enkaic/src/parser.rs` (parse_fn_decl); runtime in `enkairt/src/runtime.rs` (Interpreter::eval_module, call_user_function).
- async fn (TODO) — parser rejects async in `enkaic/src/parser.rs` (parse_item, parse_fn_decl).
- params with types/defaults (Partial) — parser in `enkaic/src/parser.rs` (parse_param); no type checker.
- type/enum/impl decls (Partial) — parsed in `enkaic/src/parser.rs` (parse_type_decl, parse_enum_decl, parse_impl_decl); no runtime effect.
- Generics/type_params (TODO) — not parsed.
- tool/policy/prompt/model/agent/memory (Partial) — parsed in `enkaic/src/parser.rs`; runtime stubs in `enkairt/src/runtime.rs` (define_tool_stub, eval_agent_decl; model/prompt stored as stubs).
- let / assignment := (Implemented, statement-only) — parser in `enkaic/src/parser.rs` (parse_let_stmt, parse_assign_or_expr_stmt); runtime in `enkairt/src/runtime.rs` (eval_stmt, assign_lvalue).
- if/else (Implemented) — parser (parse_if_stmt); runtime (eval_stmt).
- while (Implemented) — parser (parse_while_stmt); runtime (eval_stmt).
- for-in (Implemented, list-only) — parser (parse_for_stmt); runtime (eval_stmt expects Value::List).
- match statement (Implemented) — parser (parse_match_stmt, parse_match_arms); runtime (eval_stmt).
- match expression (Implemented) — parser (parse_primary -> Expr::Match); runtime (eval_match_expr).
- match patterns literal/_/ident only (Implemented) — parser (parse_pattern); runtime (match_pattern).
- try/catch statement (Implemented) — parser (parse_try_stmt); runtime (eval_stmt catches RuntimeError).
- return/break/continue (Implemented) — parser (parse_return_stmt etc.); runtime (eval_stmt).
- lambda (Implemented, expr body) — parser (parse_lambda); runtime (eval_expr for Expr::Lambda).
- list literals (Implemented) — parser (parse_primary); runtime (eval_expr).
- indexing and field access (Implemented) — parser (parse_postfix); runtime (eval_index, eval_field).
- named args (Partial) — parser (parse_arg_list); runtime supports named args for user functions only (eval_call/call_user_function).
- error propagation ? (Partial) — parser (parse_postfix -> Expr::Try); runtime treats as no-op (eval_expr).
- await/spawn unary (Partial) — parser (parse_unary); runtime returns not implemented error (eval_unary).
- assignment expression (TODO) — spec allows `expr := expr`, v0.1 enforces statement-only.

4) Operator precedence
- Precedence implementation (Implemented) — `enkaic/src/parser.rs` (parse_or/and/equality/comparison/additive/multiplicative/unary/postfix).

5) Module and package layout
- Enkai.toml / module resolution (TODO) — not implemented in CLI/runtime.
- file-based module loading (TODO) — no loader in `Enkai` or `enkairt`.

6) Standard library design
- Minimal std.core/std.io/std.collections (Partial) — built-ins in `enkairt/src/runtime.rs` (Interpreter::install_builtins).
- Rest of stdlib modules (TODO).

7) AI-native features
- tool/agent/policy/memory/prompt/model syntax (Partial) — parsed in `enkaic/src/parser.rs`.
- Capability enforcement, tool execution, model invocation (TODO) — runtime stubs only.

8) "::" nesting algorithm
- Line-based BLOCK_START/BLOCK_END algorithm (Implemented) — `enkaic/src/lexer.rs` (finish_line + block_depth).

9) Sandboxing and capability enforcement
- Capability manifest + policy enforcement (TODO).

Divergences from Enkai.spec (explicit)
- Assignment expressions (`expr := expr`) are not supported; `:=` is statement-only in v0.1 (`enkaic/src/parser.rs` parse_assign_or_expr_stmt).
- `async fn` is rejected in v0.1 (`enkaic/src/parser.rs` parse_item/parse_fn_decl).
- Match expressions disallow block arms (parser error in `enkaic/src/parser.rs` parse_match_arms with allow_block_body=false).
- Error propagation `?` is parsed but has no runtime propagation semantics (`enkairt/src/runtime.rs` eval_expr for Expr::Try is a no-op).
- `await`/`spawn` are parsed but return "not implemented" at runtime (`enkairt/src/runtime.rs` eval_unary).
- `use` only resolves built-in `std` records; no filesystem module loading (`enkairt/src/runtime.rs` eval_use_decl).
- tool/policy/agent/model/prompt/memory are parsed but do not enforce policies or execute tools/models (stubs in `enkairt/src/runtime.rs`).

